"use strict";(()=>{var e={};e.id=3626,e.ids=[3626],e.modules={67096:e=>{e.exports=require("bcrypt")},73227:e=>{e.exports=require("next-auth")},62113:e=>{e.exports=require("next-auth/next")},47449:e=>{e.exports=require("next-auth/providers/credentials")},93598:e=>{e.exports=require("next-auth/providers/google")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},18543:(e,t,r)=>{r.r(t),r.d(t,{config:()=>p,default:()=>g,routeModule:()=>f});var s={};r.r(s),r.d(s,{default:()=>l});var a=r(71802),n=r(47153),o=r(56249),i=r(62113),u=r(45884),d=r(33739);async function l(e,t){let r=await (0,i.getServerSession)(e,t,u.authOptions);if(!r)return t.status(401).json({message:"Unauthorized"});let s=r.user.id;if("GET"===e.method)try{let e=await (0,d.getUserTwoFactorSettings)(s);if(!e)return t.status(404).json({message:"Settings not found"});return t.status(200).json({settings:e})}catch(e){return console.error("Error getting 2FA settings:",e),t.status(500).json({message:"Internal server error"})}if("PUT"===e.method)try{let{enabled:r,preferred_method:a,email_enabled:n,sms_enabled:o,duo_enabled:i}=e.body;if(r&&!a)return t.status(400).json({message:"Preferred method is required when 2FA is enabled"});if(r&&a&&!e.body[`${a}_enabled`])return t.status(400).json({message:`${a} verification is not enabled`});if(!await (0,d.updateUserTwoFactorSettings)(s,{enabled:r,preferred_method:a,email_enabled:n,sms_enabled:o,duo_enabled:i}))return t.status(500).json({message:"Failed to update 2FA settings"});let u=await (0,d.getUserTwoFactorSettings)(s);return t.status(200).json({settings:u})}catch(e){return console.error("Error updating 2FA settings:",e),t.status(500).json({message:"Internal server error"})}return t.status(405).json({message:"Method not allowed"})}let g=(0,o.l)(s,"default"),p=(0,o.l)(s,"config"),f=new a.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/user/2fa/settings",pathname:"/api/user/2fa/settings",bundlePath:"",filename:""},userland:s})}};var t=require("../../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8074],()=>r(18543));module.exports=s})();