"use strict";(()=>{var e={};e.id=7292,e.ids=[7292],e.modules={5486:e=>{e.exports=require("bcrypt")},15806:e=>{e.exports=require("next-auth/next")},16382:e=>{e.exports=require("next-auth/providers/credentials")},17070:(e,s,t)=>{t.a(e,async(e,r)=>{try{t.r(s),t.d(s,{config:()=>l,default:()=>d,routeModule:()=>m});var a=t(33480),n=t(8667),i=t(86435),o=t(41952),u=e([o]);o=(u.then?(await u)():u)[0];let d=(0,i.M)(o,"default"),l=(0,i.M)(o,"config"),m=new a.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/user/2fa/send-test",pathname:"/api/user/2fa/send-test",bundlePath:"",filename:""},userland:o});r()}catch(e){r(e)}})},21572:e=>{e.exports=require("nodemailer")},41952:(e,s,t)=>{t.a(e,async(e,r)=>{try{t.r(s),t.d(s,{default:()=>d});var a=t(15806),n=t(52043),i=t(75832),o=t(64939),u=e([o]);let l=new(o=(u.then?(await u)():u)[0]).Pool({connectionString:process.env.DATABASE_URL||"postgresql://postgres:postgres@localhost:5432/mdtstech_store",ssl:{rejectUnauthorized:!1}});async function d(e,s){let t=await (0,a.getServerSession)(e,s,n.authOptions);if(!t)return s.status(401).json({message:"Unauthorized"});let r=t.user.id;if("POST"===e.method)try{let{method:t}=e.body;if(!t||!["email","sms"].includes(t))return s.status(400).json({message:"Invalid verification method"});let a=`
        SELECT email, phone_number FROM users
        WHERE id = $1
      `,n=await l.query(a,[r]);if(0===n.rows.length)return s.status(404).json({message:"User not found"});let o=n.rows[0],u=!1;if("email"===t){if(!o.email)return s.status(400).json({message:"User does not have an email address"});u=await (0,i.sendEmailVerification)(r,o.email)}else if("sms"===t){if(!o.phone_number)return s.status(400).json({message:"User does not have a phone number"});u=await (0,i.sendSmsVerification)(r,o.phone_number)}if(!u)return s.status(500).json({message:`Failed to send ${t} verification`});return s.status(200).json({message:`Test ${t} verification sent successfully`})}catch(e){return console.error("Error sending test verification:",e),s.status(500).json({message:"Internal server error"})}return s.status(405).json({message:"Method not allowed"})}r()}catch(e){r(e)}})},50804:e=>{e.exports=require("next-auth/providers/email")},64939:e=>{e.exports=import("pg")},65542:e=>{e.exports=require("next-auth")},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},77851:e=>{e.exports=require("next-auth/providers/google")}};var s=require("../../../../webpack-api-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[2622],()=>t(17070));module.exports=r})();