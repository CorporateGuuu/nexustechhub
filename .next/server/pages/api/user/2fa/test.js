"use strict";(()=>{var e={};e.id=2295,e.ids=[2295],e.modules={67096:e=>{e.exports=require("bcrypt")},73227:e=>{e.exports=require("next-auth")},62113:e=>{e.exports=require("next-auth/next")},47449:e=>{e.exports=require("next-auth/providers/credentials")},93598:e=>{e.exports=require("next-auth/providers/google")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},28406:(e,s,r)=>{r.r(s),r.d(s,{config:()=>p,default:()=>f,routeModule:()=>h});var t={};r.r(t),r.d(t,{default:()=>m});var a=r(71802),n=r(47153),i=r(56249),o=r(62113),u=r(45884),d=r(33739),l=r(51004);async function m(e,s){let r=await (0,o.getServerSession)(e,s,u.authOptions);if(!r)return s.status(401).json({message:"Unauthorized"});let t=r.user.id;if("POST"===e.method)try{let{method:r}=e.body;if(!r)return s.status(400).json({message:"Method is required"});if("email"!==r&&"sms"!==r)return s.status(400).json({message:"Invalid method"});let a=await (0,l.query)("SELECT email, phone_number FROM users WHERE id = $1",[t]);if(0===a.rows.length)return s.status(404).json({message:"User not found"});let n=a.rows[0],i=!1;if("email"===r){if(!n.email)return s.status(400).json({message:"User has no email address"});i=await (0,d.sendEmailVerification)(t,n.email)}else if("sms"===r){if(!n.phone_number)return s.status(400).json({message:"User has no phone number"});i=await (0,d.sendSmsVerification)(t,n.phone_number)}if(!i)return s.status(500).json({message:`Failed to send ${r} verification`});return s.status(200).json({success:!0})}catch(e){return console.error("Error sending test verification:",e),s.status(500).json({message:"Internal server error"})}return s.status(405).json({message:"Method not allowed"})}let f=(0,i.l)(t,"default"),p=(0,i.l)(t,"config"),h=new a.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/user/2fa/test",pathname:"/api/user/2fa/test",bundlePath:"",filename:""},userland:t})}};var s=require("../../../../webpack-api-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[8074],()=>r(28406));module.exports=t})();