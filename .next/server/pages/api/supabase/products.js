"use strict";(()=>{var e={};e.id=7434,e.ids=[7434],e.modules={20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},56249:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},68598:(e,r,t)=>{t.r(r),t.d(r,{config:()=>l,default:()=>u,routeModule:()=>d});var a={};t.r(a),t.d(a,{default:()=>i});var o=t(71802),s=t(47153),n=t(56249),c=t(98456);async function i(e,r){if("GET"===e.method)try{let{page:t=1,limit:a=20,category:o}=e.query,s=(t-1)*a,n=c.ZP.from("products").select(`
          *,
          categories(name)
        `).order("created_at",{ascending:!1}).range(s,s+a-1);o&&(n=n.eq("category_id",o));let{data:i,error:u,count:l}=await n;if(u)throw u;let d=i.map(e=>({...e,price:parseFloat(e.price),discount_percentage:parseFloat(e.discount_percentage||0),discounted_price:e.discount_percentage?parseFloat((e.price*(1-e.discount_percentage/100)).toFixed(2)):parseFloat(e.price),category_name:e.categories?.name}));return r.status(200).json({success:!0,products:d,total:l,page:parseInt(t),limit:parseInt(a),total_pages:Math.ceil(l/a)})}catch(e){return console.error("Error fetching products:",e),r.status(500).json({success:!1,message:"Error fetching products",error:e.message})}else if("POST"!==e.method)return r.status(405).json({success:!1,message:"Method not allowed"});else try{let{name:t,slug:a,description:o,price:s,category_id:n,image_url:i,stock_quantity:u,discount_percentage:l,is_featured:d,is_new:p,brand:g}=e.body;if(!t||!a||!s||!n)return r.status(400).json({success:!1,message:"Missing required fields"});let{data:m,error:P}=await c.ZP.from("products").insert([{name:t,slug:a,description:o,price:s,category_id:n,image_url:i,stock_quantity:u||0,discount_percentage:l||0,is_featured:d||!1,is_new:p||!1,brand:g}]).select();if(P)throw P;return r.status(201).json({success:!0,message:"Product created successfully",product:m[0]})}catch(e){return console.error("Error creating product:",e),r.status(500).json({success:!1,message:"Error creating product",error:e.message})}}let u=(0,n.l)(a,"default"),l=(0,n.l)(a,"config"),d=new o.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/supabase/products",pathname:"/api/supabase/products",bundlePath:"",filename:""},userland:a})},98456:(e,r,t)=>{t.d(r,{ZP:()=>s,fU:()=>o});let a={auth:{signUp:async e=>(console.log("Supabase signUp:",e),{data:{user:{id:"mock-user-id",email:e.email}},error:null}),signInWithPassword:async e=>(console.log("Supabase signIn:",e),{data:{user:{id:"mock-user-id",email:e.email}},error:null}),signOut:async()=>(console.log("Supabase signOut"),{error:null}),getUser:async()=>(console.log("Supabase getUser"),{data:{user:{id:"mock-user-id",email:"demo@example.com"}},error:null})},from:e=>({select:(e="*")=>({eq:(e,r)=>({data:[],error:null}),order:(e,r)=>({data:[],error:null}),limit:e=>({data:[],error:null}),data:[],error:null}),insert:e=>({data:Array.isArray(e)?e:[e],error:null}),update:e=>({eq:(r,t)=>({data:[e],error:null})}),delete:()=>({eq:(e,r)=>({data:[],error:null})})})},o=(e,r)=>(console.log("Creating server Supabase client"),a),s={supabase:a,createClient:(e,r)=>(console.log("Creating Supabase client"),a),createServerSupabaseClient:o,getProducts:async(e={})=>(console.log("Getting products from Supabase:",e),{data:[{id:1,name:"iPhone 15 Pro Screen Assembly",price:299.99,stock:25,category:"iPhone Parts",image:"/images/products/iphone-15-pro-screen.jpg"},{id:2,name:"Samsung Galaxy S24 Battery",price:89.99,stock:50,category:"Samsung Parts",image:"/images/products/samsung-s24-battery.jpg"}],error:null}),getProduct:async e=>(console.log(`Getting product ${e} from Supabase`),{data:{id:e,name:"iPhone 15 Pro Screen Assembly",price:299.99,stock:25,category:"iPhone Parts",description:"High-quality OLED screen assembly for iPhone 15 Pro",image:"/images/products/iphone-15-pro-screen.jpg"},error:null}),createProduct:async e=>(console.log("Creating product in Supabase:",e),{data:{id:Date.now(),...e,created_at:new Date().toISOString()},error:null}),updateProduct:async(e,r)=>(console.log(`Updating product ${e} in Supabase:`,r),{data:{id:e,...r,updated_at:new Date().toISOString()},error:null}),getCart:async e=>(console.log(`Getting cart for user ${e} from Supabase`),{data:[],error:null}),addToCart:async(e,r,t)=>(console.log(`Adding to cart: user ${e}, product ${r}, qty ${t}`),{data:{id:Date.now(),user_id:e,product_id:r,quantity:t,created_at:new Date().toISOString()},error:null}),updateCartItem:async(e,r)=>(console.log(`Updating cart item ${e} to quantity ${r}`),{data:{id:e,quantity:r,updated_at:new Date().toISOString()},error:null}),removeFromCart:async e=>(console.log(`Removing cart item ${e}`),{data:null,error:null})}},47153:(e,r)=>{var t;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},71802:(e,r,t)=>{e.exports=t(20145)}};var r=require("../../../webpack-api-runtime.js");r.C(e);var t=r(r.s=68598);module.exports=t})();