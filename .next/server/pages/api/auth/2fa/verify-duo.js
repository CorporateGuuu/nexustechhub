"use strict";(()=>{var e={};e.id=2816,e.ids=[2816],e.modules={20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},56249:(e,s)=>{Object.defineProperty(s,"l",{enumerable:!0,get:function(){return function e(s,o){return o in s?s[o]:"then"in s&&"function"==typeof s.then?s.then(s=>e(s,o)):"function"==typeof s&&"default"===o?s:void 0}}})},97745:(e,s,o)=>{o.r(s),o.d(s,{config:()=>d,default:()=>u,routeModule:()=>l});var n={};o.r(n),o.d(n,{default:()=>c});var r=o(71802),t=o(47153),a=o(56249),i=o(33739);async function c(e,s){if("POST"!==e.method)return s.status(405).json({message:"Method not allowed"});try{let{userId:o,signedResponse:n}=e.body;if(!o||!n)return s.status(400).json({message:"Invalid request parameters"});if(!(0,i.verifyDuoResponse)(n))return s.status(400).json({message:"Invalid DUO response"});return s.setHeader("Set-Cookie","twoFactorVerified=true; Path=/; HttpOnly; SameSite=Strict; Max-Age=3600"),s.status(200).json({message:"DUO verification successful"})}catch(e){return console.error("Error verifying DUO response:",e),s.status(500).json({message:"Internal server error"})}}let u=(0,a.l)(n,"default"),d=(0,a.l)(n,"config"),l=new r.PagesAPIRouteModule({definition:{kind:t.x.PAGES_API,page:"/api/auth/2fa/verify-duo",pathname:"/api/auth/2fa/verify-duo",bundlePath:"",filename:""},userland:n})},33739:(e,s,o)=>{o.r(s),o.d(s,{default:()=>y,disable2FA:()=>a,enable2FA:()=>t,generate2FASecret:()=>r,generateBackupCodes:()=>u,generateDuoRequest:()=>l,getUserTwoFactorSettings:()=>i,sendEmailVerification:()=>g,sendSmsVerification:()=>A,sendTwoFactorCode:()=>c,updateUserTwoFactorSettings:()=>m,verify2FA:()=>n,verifyBackupCode:()=>d,verifyCode:()=>p,verifyDuoResponse:()=>f});let n=async(e,s,o="email")=>(console.log(`2FA verification for user ${e} with code ${s} via ${o}`),{success:!0,verified:!0}),r=async e=>(console.log(`Generating 2FA secret for user ${e}`),{secret:"MOCK2FASECRET123456789",qrCode:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="}),t=async(e,s="email")=>(console.log(`Enabling 2FA for user ${e} via ${s}`),{success:!0,enabled:!0,method:s}),a=async e=>(console.log(`Disabling 2FA for user ${e}`),{success:!0,enabled:!1}),i=async e=>(console.log(`Getting 2FA settings for user ${e}`),{enabled:!1,email_enabled:!1,sms_enabled:!1,duo_enabled:!1,preferred_method:"email",backup_codes_count:0}),c=async(e,s="email")=>(console.log(`Sending 2FA code to user ${e} via ${s}`),{success:!0,sent:!0,method:s,code:"123456"}),u=async e=>{console.log(`Generating backup codes for user ${e}`);let s=[];for(let e=0;e<10;e++)s.push(Math.random().toString(36).substring(2,10).toUpperCase());return{success:!0,codes:s}},d=async(e,s)=>(console.log(`Verifying backup code for user ${e}: ${s}`),{success:!0,verified:!0,remaining_codes:9}),l=async e=>(console.log(`Generating Duo request for user ${e}`),{success:!0,duo_request:"TX|mock-duo-request|mock-app-id",duo_host:"api-mock.duosecurity.com"}),f=async(e,s)=>(console.log(`Verifying Duo response for user ${s}: ${e}`),{success:!0,verified:!0,username:`user_${s}`}),g=async(e,s)=>(console.log(`Sending email verification to ${s} for user ${e}`),{success:!0,sent:!0,code:"123456",expires_at:new Date(Date.now()+3e5).toISOString()}),A=async(e,s)=>(console.log(`Sending SMS verification to ${s} for user ${e}`),{success:!0,sent:!0,code:"654321",expires_at:new Date(Date.now()+3e5).toISOString()}),p=async(e,s,o="email")=>(console.log(`Verifying ${o} code ${s} for user ${e}`),{success:!0,verified:!0,method:o}),m=async(e,s)=>(console.log(`Updating 2FA settings for user ${e}:`,s),{success:!0,settings:{...s,updated_at:new Date().toISOString()}}),y={verify2FA:n,generate2FASecret:r,enable2FA:t,disable2FA:a,getUserTwoFactorSettings:i,sendTwoFactorCode:c,generateBackupCodes:u,verifyBackupCode:d,generateDuoRequest:l,verifyDuoResponse:f,sendEmailVerification:g,sendSmsVerification:A,verifyCode:p,updateUserTwoFactorSettings:m}},47153:(e,s)=>{var o;Object.defineProperty(s,"x",{enumerable:!0,get:function(){return o}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(o||(o={}))},71802:(e,s,o)=>{e.exports=o(20145)}};var s=require("../../../../webpack-api-runtime.js");s.C(e);var o=s(s.s=97745);module.exports=o})();