"use strict";(()=>{var e={};e.id=5884,e.ids=[5884],e.modules={8667:(e,s)=>{Object.defineProperty(s,"A",{enumerable:!0,get:function(){return o}});var o=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},18005:(e,s,o)=>{o.r(s),o.d(s,{config:()=>d,default:()=>u,routeModule:()=>l});var r={};o.r(r),o.d(r,{default:()=>c});var n=o(33480),t=o(8667),a=o(86435),i=o(75832);async function c(e,s){if("POST"!==e.method)return s.status(405).json({message:"Method not allowed"});try{let{userId:o,code:r}=e.body;if(!o||!r)return s.status(400).json({message:"Invalid request parameters"});if(!await (0,i.verifyBackupCode)(o,r))return s.status(400).json({message:"Invalid backup code"});return s.setHeader("Set-Cookie","twoFactorVerified=true; Path=/; HttpOnly; SameSite=Strict; Max-Age=3600"),s.status(200).json({message:"Verification successful"})}catch(e){return console.error("Error verifying backup code:",e),s.status(500).json({message:"Internal server error"})}}let u=(0,a.M)(r,"default"),d=(0,a.M)(r,"config"),l=new n.PagesAPIRouteModule({definition:{kind:t.A.PAGES_API,page:"/api/auth/2fa/verify-backup-code",pathname:"/api/auth/2fa/verify-backup-code",bundlePath:"",filename:""},userland:r})},33480:(e,s,o)=>{e.exports=o(75600)},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},75832:(e,s,o)=>{o.r(s),o.d(s,{default:()=>y,disable2FA:()=>a,enable2FA:()=>t,generate2FASecret:()=>n,generateBackupCodes:()=>u,generateDuoRequest:()=>l,getUserTwoFactorSettings:()=>i,sendEmailVerification:()=>g,sendSmsVerification:()=>A,sendTwoFactorCode:()=>c,updateUserTwoFactorSettings:()=>m,verify2FA:()=>r,verifyBackupCode:()=>d,verifyCode:()=>p,verifyDuoResponse:()=>f});let r=async(e,s,o="email")=>(console.log(`2FA verification for user ${e} with code ${s} via ${o}`),{success:!0,verified:!0}),n=async e=>(console.log(`Generating 2FA secret for user ${e}`),{secret:"MOCK2FASECRET123456789",qrCode:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="}),t=async(e,s="email")=>(console.log(`Enabling 2FA for user ${e} via ${s}`),{success:!0,enabled:!0,method:s}),a=async e=>(console.log(`Disabling 2FA for user ${e}`),{success:!0,enabled:!1}),i=async e=>(console.log(`Getting 2FA settings for user ${e}`),{enabled:!1,email_enabled:!1,sms_enabled:!1,duo_enabled:!1,preferred_method:"email",backup_codes_count:0}),c=async(e,s="email")=>(console.log(`Sending 2FA code to user ${e} via ${s}`),{success:!0,sent:!0,method:s,code:"123456"}),u=async e=>{console.log(`Generating backup codes for user ${e}`);let s=[];for(let e=0;e<10;e++)s.push(Math.random().toString(36).substring(2,10).toUpperCase());return{success:!0,codes:s}},d=async(e,s)=>(console.log(`Verifying backup code for user ${e}: ${s}`),{success:!0,verified:!0,remaining_codes:9}),l=async e=>(console.log(`Generating Duo request for user ${e}`),{success:!0,duo_request:"TX|mock-duo-request|mock-app-id",duo_host:"api-mock.duosecurity.com"}),f=async(e,s)=>(console.log(`Verifying Duo response for user ${s}: ${e}`),{success:!0,verified:!0,username:`user_${s}`}),g=async(e,s)=>(console.log(`Sending email verification to ${s} for user ${e}`),{success:!0,sent:!0,code:"123456",expires_at:new Date(Date.now()+3e5).toISOString()}),A=async(e,s)=>(console.log(`Sending SMS verification to ${s} for user ${e}`),{success:!0,sent:!0,code:"654321",expires_at:new Date(Date.now()+3e5).toISOString()}),p=async(e,s,o="email")=>(console.log(`Verifying ${o} code ${s} for user ${e}`),{success:!0,verified:!0,method:o}),m=async(e,s)=>(console.log(`Updating 2FA settings for user ${e}:`,s),{success:!0,settings:{...s,updated_at:new Date().toISOString()}}),y={verify2FA:r,generate2FASecret:n,enable2FA:t,disable2FA:a,getUserTwoFactorSettings:i,sendTwoFactorCode:c,generateBackupCodes:u,verifyBackupCode:d,generateDuoRequest:l,verifyDuoResponse:f,sendEmailVerification:g,sendSmsVerification:A,verifyCode:p,updateUserTwoFactorSettings:m}},86435:(e,s)=>{Object.defineProperty(s,"M",{enumerable:!0,get:function(){return function e(s,o){return o in s?s[o]:"then"in s&&"function"==typeof s.then?s.then(s=>e(s,o)):"function"==typeof s&&"default"===o?s:void 0}}})}};var s=require("../../../../webpack-api-runtime.js");s.C(e);var o=s(s.s=18005);module.exports=o})();