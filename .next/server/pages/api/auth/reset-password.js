"use strict";(()=>{var e={};e.id=9561,e.ids=[9561],e.modules={8667:(e,s)=>{Object.defineProperty(s,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},13490:(e,s,t)=>{t.a(e,async(e,r)=>{try{t.r(s),t.d(s,{config:()=>l,default:()=>u,routeModule:()=>d});var a=t(33480),o=t(8667),n=t(86435),i=t(74549),c=e([i]);i=(c.then?(await c)():c)[0];let u=(0,n.M)(i,"default"),l=(0,n.M)(i,"config"),d=new a.PagesAPIRouteModule({definition:{kind:o.A.PAGES_API,page:"/api/auth/reset-password",pathname:"/api/auth/reset-password",bundlePath:"",filename:""},userland:i});r()}catch(e){r(e)}})},33480:(e,s,t)=>{e.exports=t(75600)},74549:(e,s,t)=>{t.a(e,async(e,r)=>{try{t.r(s),t.d(s,{default:()=>i});var a=t(75217),o=t(93139),n=e([o]);async function i(e,s){if("POST"!==e.method)return s.status(405).json({success:!1,message:"Method not allowed"});let{token:t,password:r}=e.body;if(!t||!r)return s.status(400).json({success:!1,message:"Token and password are required"});if(r.length<8)return s.status(400).json({success:!1,message:"Password must be at least 8 characters long"});try{let e=await a.pool.query(`SELECT user_id, expires_at FROM password_reset_tokens 
       WHERE token = $1 AND expires_at > NOW()`,[t]);if(0===e.rows.length)return s.status(400).json({success:!1,message:"Invalid or expired token. Please request a new password reset link."});let n=e.rows[0].user_id,i=await o.default.hash(r,10);return await a.pool.query("UPDATE users SET password = $1, updated_at = NOW() WHERE id = $2",[i,n]),await a.pool.query("DELETE FROM password_reset_tokens WHERE user_id = $1",[n]),s.status(200).json({success:!0,message:"Password has been reset successfully"})}catch(e){return console.error("Error in reset password:",e),s.status(500).json({success:!1,message:"An error occurred. Please try again."})}}o=(n.then?(await n)():n)[0],r()}catch(e){r(e)}})},75217:(e,s,t)=>{t.r(s),t.d(s,{createUser:()=>n,default:()=>P,getCategories:()=>g,getCategoryBySlug:()=>d,getConnection:()=>a,getProductBySlug:()=>p,getProducts:()=>y,getUserByEmail:()=>i,getUserById:()=>c,pool:()=>l,query:()=>r,transaction:()=>o,updateUser:()=>u});let r=async(e,s=[])=>(console.log(`Database query: ${e}`,s),{rows:[],rowCount:0}),a=async()=>(console.log("Getting database connection"),{query:r,release:()=>console.log("Connection released")}),o=async e=>{console.log("Starting database transaction");let s=await a();try{await s.query("BEGIN");let t=await e(s);return await s.query("COMMIT"),t}catch(e){throw await s.query("ROLLBACK"),e}finally{s.release()}},n=async e=>(console.log("Creating user:",e),{id:"mock-user-id",...e}),i=async e=>(console.log("Getting user by email:",e),null),c=async e=>(console.log("Getting user by ID:",e),null),u=async(e,s)=>(console.log("Updating user:",e,s),{id:e,...s}),l={query:async(e,s=[])=>(console.log(`Pool query: ${e}`,s),{rows:[],rowCount:0}),connect:async()=>(console.log("Pool connection established"),{query:async(e,s=[])=>(console.log(`Connection query: ${e}`,s),{rows:[],rowCount:0}),release:()=>console.log("Connection released")})},d=async e=>(console.log(`Getting category by slug: ${e}`),{id:1,name:"iPhone Parts",slug:e,description:"High-quality iPhone replacement parts"}),g=async()=>(console.log("Getting all categories"),[{id:1,name:"iPhone Parts",slug:"iphone-parts"},{id:2,name:"Samsung Parts",slug:"samsung-parts"},{id:3,name:"iPad Parts",slug:"ipad-parts"},{id:4,name:"Tools",slug:"tools"}]),y=async(e={})=>(console.log("Getting products with filters:",e),[{id:1,name:"iPhone 15 Pro Screen",slug:"iphone-15-pro-screen",price:299.99,category:"iPhone Parts"},{id:2,name:"Samsung S24 Battery",slug:"samsung-s24-battery",price:89.99,category:"Samsung Parts"}]),p=async e=>(console.log(`Getting product by slug: ${e}`),{id:1,name:"iPhone 15 Pro Screen",slug:e,price:299.99,description:"High-quality OLED screen replacement for iPhone 15 Pro",category:"iPhone Parts"}),P={query:r,getConnection:a,transaction:o,createUser:n,getUserByEmail:i,getUserById:c,updateUser:u,pool:l,getCategoryBySlug:d,getCategories:g,getProducts:y,getProductBySlug:p}},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},86435:(e,s)=>{Object.defineProperty(s,"M",{enumerable:!0,get:function(){return function e(s,t){return t in s?s[t]:"then"in s&&"function"==typeof s.then?s.then(s=>e(s,t)):"function"==typeof s&&"default"===t?s:void 0}}})},93139:e=>{e.exports=import("bcryptjs")}};var s=require("../../../webpack-api-runtime.js");s.C(e);var t=s(s.s=13490);module.exports=t})();