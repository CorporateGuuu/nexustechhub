(()=>{var e={};e.id=5659,e.ids=[636,5659],e.modules={4424:e=>{e.exports={container:"AdminPages_container__nj6XB",pageHeader:"AdminPages_pageHeader__LHSBG",addButton:"AdminPages_addButton__3YV2v",filterBar:"AdminPages_filterBar__fJxVO",filterGroup:"AdminPages_filterGroup__CvemU",select:"AdminPages_select__5v_Ue",searchForm:"AdminPages_searchForm__DxHvp",searchInput:"AdminPages_searchInput__czn7m",searchButton:"AdminPages_searchButton__HrKq3",tableContainer:"AdminPages_tableContainer__EZ3Ac",table:"AdminPages_table__KVh8N",sortableColumn:"AdminPages_sortableColumn___99vU",activeSortColumn:"AdminPages_activeSortColumn__pPIua",sortIcon:"AdminPages_sortIcon__tiBuk",imageColumn:"AdminPages_imageColumn__m3_De",imageCell:"AdminPages_imageCell__ahCj4",productImage:"AdminPages_productImage__8KMQy",stockBadge:"AdminPages_stockBadge__Uquo4",inStock:"AdminPages_inStock__4D2jV",lowStock:"AdminPages_lowStock__JQmaX",outOfStock:"AdminPages_outOfStock__PVOkV",stockCount:"AdminPages_stockCount__CJVuo",actions:"AdminPages_actions__5NUWv",actionButton:"AdminPages_actionButton__A25EK",editButton:"AdminPages_editButton__xhIdN",deleteButton:"AdminPages_deleteButton__wFOYO",ordersButton:"AdminPages_ordersButton__nuIHY",updateButton:"AdminPages_updateButton__TKzfU",statusBadge:"AdminPages_statusBadge__vf_aR",statusPending:"AdminPages_statusPending__uo129",statusProcessing:"AdminPages_statusProcessing__mabVA",statusShipped:"AdminPages_statusShipped__Jc_6I",statusDelivered:"AdminPages_statusDelivered__falDE",statusCancelled:"AdminPages_statusCancelled__fxl2i",statusDropdown:"AdminPages_statusDropdown__FTpQA",dropdownContent:"AdminPages_dropdownContent__4sAyN",activeStatus:"AdminPages_activeStatus__rh9Cs",noData:"AdminPages_noData__Mc9eU",pagination:"AdminPages_pagination__1uxxQ",paginationButton:"AdminPages_paginationButton__kiY8c",pageInfo:"AdminPages_pageInfo__XD0jp",loading:"AdminPages_loading__zLU2R",spinner:"AdminPages_spinner__lVOQO",spin:"AdminPages_spin__s6LXq",settingsContainer:"AdminPages_settingsContainer__yidTp",settingsTabs:"AdminPages_settingsTabs__Iw9Zr",tabButton:"AdminPages_tabButton__Swz33",activeTab:"AdminPages_activeTab___YGm8",settingsContent:"AdminPages_settingsContent__5zi5i",settingsForm:"AdminPages_settingsForm__6w8pE",formGroup:"AdminPages_formGroup__MbgWF",input:"AdminPages_input__NjzSf",textarea:"AdminPages_textarea__zm7h5",checkboxLabel:"AdminPages_checkboxLabel__QnbQ4",helpText:"AdminPages_helpText__6QXDW",formRow:"AdminPages_formRow__vrK66",formActions:"AdminPages_formActions__6_1in",saveButton:"AdminPages_saveButton__aoM8K",successMessage:"AdminPages_successMessage__42J_F",errorMessage:"AdminPages_errorMessage__CBbWX",shippingRate:"AdminPages_shippingRate__4pZsF",removeButton:"AdminPages_removeButton__k0hN8",paymentSection:"AdminPages_paymentSection___O13P",securitySection:"AdminPages_securitySection__lvIFb",testButton:"AdminPages_testButton__Xov_6"}},4722:e=>{"use strict";e.exports=require("next-auth/react")},6876:e=>{"use strict";e.exports=import("web-vitals")},8732:e=>{"use strict";e.exports=require("react/jsx-runtime")},22326:e=>{"use strict";e.exports=require("react-dom")},27910:e=>{"use strict";e.exports=require("stream")},29021:e=>{"use strict";e.exports=require("fs")},33873:e=>{"use strict";e.exports=require("path")},40361:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},74075:e=>{"use strict";e.exports=require("zlib")},82015:e=>{"use strict";e.exports=require("react")},83240:(e,t,s)=>{"use strict";s.r(t),s.d(t,{config:()=>N,default:()=>j,getServerSideProps:()=>f,getStaticPaths:()=>C,getStaticProps:()=>b,reportWebVitals:()=>B,routeModule:()=>M,unstable_getServerProps:()=>D,unstable_getServerSideProps:()=>I,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>w,unstable_getStaticProps:()=>k});var a={};s.r(a),s.d(a,{default:()=>v,getServerSideProps:()=>S});var n=s(63885),r=s(80237),i=s(81413),o=s(89674),d=s(85521),c=s(8732),l=s(82015),u=s(4722),_=s(44233),m=s(49788),g=s.n(m),p=s(19918),h=s.n(p),P=s(22371),x=s(4424),A=s.n(x);function v(){let{data:e}=(0,u.useSession)(),[t,s]=(0,l.useState)([]),[a,n]=(0,l.useState)(!0),[r,i]=(0,l.useState)("all"),[o,d]=(0,l.useState)(""),[m,p]=(0,l.useState)("created_at"),[x,v]=(0,l.useState)("desc"),[S,j]=(0,l.useState)(1),[b,C]=(0,l.useState)(1);async function f(){try{n(!0);let e=new URLSearchParams;e.append("filter",r),e.append("search",o),e.append("sortBy",m),e.append("sortOrder",x),e.append("page",S),e.append("limit",10);let t=await fetch(`/api/admin/orders?${e.toString()}`);if(!t.ok)throw Error("Failed to fetch orders");let a=await t.json();s(a.orders),C(a.totalPages),n(!1)}catch(e){console.error("Error fetching orders:",e),n(!1)}}(0,_.useRouter)();let N=e=>{m===e?v("asc"===x?"desc":"asc"):(p(e),v("desc")),j(1)},B=e=>{e>=1&&e<=b&&j(e)},k=async(e,t)=>{try{if(!(await fetch(`/api/admin/orders/${e}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok)throw Error("Failed to update order status");f()}catch(e){console.error("Error updating order status:",e),alert("Failed to update order status. Please try again.")}},w=e=>new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),y=e=>{switch(e.toLowerCase()){case"pending":return A().statusPending;case"processing":return A().statusProcessing;case"shipped":return A().statusShipped;case"delivered":return A().statusDelivered;case"cancelled":return A().statusCancelled;default:return""}};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(g(),{children:(0,c.jsx)("title",{children:"Orders | Admin Dashboard"})}),(0,c.jsxs)(P.A,{children:[(0,c.jsx)("div",{className:A().pageHeader,children:(0,c.jsx)("h1",{children:"Orders"})}),(0,c.jsxs)("div",{className:A().filterBar,children:[(0,c.jsxs)("div",{className:A().filterGroup,children:[(0,c.jsx)("label",{htmlFor:"filter",children:"Filter:"}),(0,c.jsxs)("select",{id:"filter",value:r,onChange:e=>{i(e.target.value),j(1)},className:A().select,children:[(0,c.jsx)("option",{value:"all",children:"All Orders"}),(0,c.jsx)("option",{value:"pending",children:"Pending"}),(0,c.jsx)("option",{value:"processing",children:"Processing"}),(0,c.jsx)("option",{value:"shipped",children:"Shipped"}),(0,c.jsx)("option",{value:"delivered",children:"Delivered"}),(0,c.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,c.jsxs)("form",{onSubmit:e=>{e.preventDefault(),j(1),f()},className:A().searchForm,children:[(0,c.jsx)("input",{type:"text",placeholder:"Search by order # or customer...",value:o,onChange:e=>{d(e.target.value)},className:A().searchInput}),(0,c.jsx)("button",{type:"submit",className:A().searchButton,children:"Search"})]})]}),a?(0,c.jsxs)("div",{className:A().loading,children:[(0,c.jsx)("div",{className:A().spinner}),(0,c.jsx)("p",{children:"Loading orders..."})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:A().tableContainer,children:(0,c.jsxs)("table",{className:A().table,children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[(0,c.jsxs)("th",{className:`${A().sortableColumn} ${"order_number"===m?A().activeSortColumn:""}`,onClick:()=>N("order_number"),children:["Order #","order_number"===m&&(0,c.jsx)("span",{className:A().sortIcon,children:"asc"===x?"↑":"↓"})]}),(0,c.jsxs)("th",{className:`${A().sortableColumn} ${"customer_name"===m?A().activeSortColumn:""}`,onClick:()=>N("customer_name"),children:["Customer","customer_name"===m&&(0,c.jsx)("span",{className:A().sortIcon,children:"asc"===x?"↑":"↓"})]}),(0,c.jsxs)("th",{className:`${A().sortableColumn} ${"created_at"===m?A().activeSortColumn:""}`,onClick:()=>N("created_at"),children:["Date","created_at"===m&&(0,c.jsx)("span",{className:A().sortIcon,children:"asc"===x?"↑":"↓"})]}),(0,c.jsxs)("th",{className:`${A().sortableColumn} ${"total_amount"===m?A().activeSortColumn:""}`,onClick:()=>N("total_amount"),children:["Total","total_amount"===m&&(0,c.jsx)("span",{className:A().sortIcon,children:"asc"===x?"↑":"↓"})]}),(0,c.jsxs)("th",{className:`${A().sortableColumn} ${"status"===m?A().activeSortColumn:""}`,onClick:()=>N("status"),children:["Status","status"===m&&(0,c.jsx)("span",{className:A().sortIcon,children:"asc"===x?"↑":"↓"})]}),(0,c.jsx)("th",{children:"Actions"})]})}),(0,c.jsx)("tbody",{children:t.length>0?t.map(e=>(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:e.order_number}),(0,c.jsx)("td",{children:e.customer_name}),(0,c.jsx)("td",{children:w(e.created_at)}),(0,c.jsxs)("td",{children:["$",e.total_amount.toFixed(2)]}),(0,c.jsx)("td",{children:(0,c.jsx)("span",{className:`${A().statusBadge} ${y(e.status)}`,children:e.status})}),(0,c.jsxs)("td",{className:A().actions,children:[(0,c.jsx)(h(),{href:`/admin/orders/${e.id}`,className:A().actionButton,children:"View"}),(0,c.jsxs)("div",{className:A().statusDropdown,children:[(0,c.jsx)("button",{className:`${A().actionButton} ${A().updateButton}`,children:"Update Status"}),(0,c.jsxs)("div",{className:A().dropdownContent,children:[(0,c.jsx)("button",{onClick:()=>k(e.id,"pending"),className:"pending"===e.status?A().activeStatus:"",children:"Pending"}),(0,c.jsx)("button",{onClick:()=>k(e.id,"processing"),className:"processing"===e.status?A().activeStatus:"",children:"Processing"}),(0,c.jsx)("button",{onClick:()=>k(e.id,"shipped"),className:"shipped"===e.status?A().activeStatus:"",children:"Shipped"}),(0,c.jsx)("button",{onClick:()=>k(e.id,"delivered"),className:"delivered"===e.status?A().activeStatus:"",children:"Delivered"}),(0,c.jsx)("button",{onClick:()=>k(e.id,"cancelled"),className:"cancelled"===e.status?A().activeStatus:"",children:"Cancelled"})]})]})]})]},e.id)):(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:"6",className:A().noData,children:"No orders found"})})})]})}),(0,c.jsxs)("div",{className:A().pagination,children:[(0,c.jsx)("button",{onClick:()=>B(1),disabled:1===S,className:A().paginationButton,children:"First"}),(0,c.jsx)("button",{onClick:()=>B(S-1),disabled:1===S,className:A().paginationButton,children:"Previous"}),(0,c.jsxs)("span",{className:A().pageInfo,children:["Page ",S," of ",b]}),(0,c.jsx)("button",{onClick:()=>B(S+1),disabled:S===b,className:A().paginationButton,children:"Next"}),(0,c.jsx)("button",{onClick:()=>B(b),disabled:S===b,className:A().paginationButton,children:"Last"})]})]})]})]})}async function S(e){let t=await (0,u.getSession)(e);return t?{props:{session:t}}:{redirect:{destination:"/auth/signin?callbackUrl=/admin/orders",permanent:!1}}}let j=(0,i.M)(a,"default"),b=(0,i.M)(a,"getStaticProps"),C=(0,i.M)(a,"getStaticPaths"),f=(0,i.M)(a,"getServerSideProps"),N=(0,i.M)(a,"config"),B=(0,i.M)(a,"reportWebVitals"),k=(0,i.M)(a,"unstable_getStaticProps"),w=(0,i.M)(a,"unstable_getStaticPaths"),y=(0,i.M)(a,"unstable_getStaticParams"),D=(0,i.M)(a,"unstable_getServerProps"),I=(0,i.M)(a,"unstable_getServerSideProps"),M=new n.PagesRouteModule({definition:{kind:r.A.PAGES,page:"/admin/orders",pathname:"/admin/orders",bundlePath:"",filename:""},components:{App:d.default,Document:o.default},userland:a})}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[6089,8854,2341,7358,5521,8172],()=>s(83240));module.exports=a})();