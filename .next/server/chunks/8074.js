"use strict";exports.id=8074,exports.ids=[8074],exports.modules={56249:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,s){return s in r?r[s]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,s)):"function"==typeof r&&"default"===s?r:void 0}}})},33739:(e,r,s)=>{s.r(r),s.d(r,{default:()=>f,disable2FA:()=>o,enable2FA:()=>n,generate2FASecret:()=>a,generateBackupCodes:()=>c,generateDuoRequest:()=>d,getUserTwoFactorSettings:()=>i,sendEmailVerification:()=>g,sendSmsVerification:()=>y,sendTwoFactorCode:()=>l,updateUserTwoFactorSettings:()=>_,verify2FA:()=>t,verifyBackupCode:()=>u,verifyCode:()=>p,verifyDuoResponse:()=>m});let t=async(e,r,s="email")=>(console.log(`2FA verification for user ${e} with code ${r} via ${s}`),{success:!0,verified:!0}),a=async e=>(console.log(`Generating 2FA secret for user ${e}`),{secret:"MOCK2FASECRET123456789",qrCode:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="}),n=async(e,r="email")=>(console.log(`Enabling 2FA for user ${e} via ${r}`),{success:!0,enabled:!0,method:r}),o=async e=>(console.log(`Disabling 2FA for user ${e}`),{success:!0,enabled:!1}),i=async e=>(console.log(`Getting 2FA settings for user ${e}`),{enabled:!1,email_enabled:!1,sms_enabled:!1,duo_enabled:!1,preferred_method:"email",backup_codes_count:0}),l=async(e,r="email")=>(console.log(`Sending 2FA code to user ${e} via ${r}`),{success:!0,sent:!0,method:r,code:"123456"}),c=async e=>{console.log(`Generating backup codes for user ${e}`);let r=[];for(let e=0;e<10;e++)r.push(Math.random().toString(36).substring(2,10).toUpperCase());return{success:!0,codes:r}},u=async(e,r)=>(console.log(`Verifying backup code for user ${e}: ${r}`),{success:!0,verified:!0,remaining_codes:9}),d=async e=>(console.log(`Generating Duo request for user ${e}`),{success:!0,duo_request:"TX|mock-duo-request|mock-app-id",duo_host:"api-mock.duosecurity.com"}),m=async(e,r)=>(console.log(`Verifying Duo response for user ${r}: ${e}`),{success:!0,verified:!0,username:`user_${r}`}),g=async(e,r)=>(console.log(`Sending email verification to ${r} for user ${e}`),{success:!0,sent:!0,code:"123456",expires_at:new Date(Date.now()+3e5).toISOString()}),y=async(e,r)=>(console.log(`Sending SMS verification to ${r} for user ${e}`),{success:!0,sent:!0,code:"654321",expires_at:new Date(Date.now()+3e5).toISOString()}),p=async(e,r,s="email")=>(console.log(`Verifying ${s} code ${r} for user ${e}`),{success:!0,verified:!0,method:s}),_=async(e,r)=>(console.log(`Updating 2FA settings for user ${e}:`,r),{success:!0,settings:{...r,updated_at:new Date().toISOString()}}),f={verify2FA:t,generate2FASecret:a,enable2FA:n,disable2FA:o,getUserTwoFactorSettings:i,sendTwoFactorCode:l,generateBackupCodes:c,verifyBackupCode:u,generateDuoRequest:d,verifyDuoResponse:m,sendEmailVerification:g,sendSmsVerification:y,verifyCode:p,updateUserTwoFactorSettings:_}},51004:(e,r,s)=>{s.r(r),s.d(r,{createUser:()=>o,default:()=>p,getCategories:()=>m,getCategoryBySlug:()=>d,getConnection:()=>a,getProductBySlug:()=>y,getProducts:()=>g,getUserByEmail:()=>i,getUserById:()=>l,pool:()=>u,query:()=>t,transaction:()=>n,updateUser:()=>c});let t=async(e,r=[])=>(console.log(`Database query: ${e}`,r),{rows:[],rowCount:0}),a=async()=>(console.log("Getting database connection"),{query:t,release:()=>console.log("Connection released")}),n=async e=>{console.log("Starting database transaction");let r=await a();try{await r.query("BEGIN");let s=await e(r);return await r.query("COMMIT"),s}catch(e){throw await r.query("ROLLBACK"),e}finally{r.release()}},o=async e=>(console.log("Creating user:",e),{id:"mock-user-id",...e}),i=async e=>(console.log("Getting user by email:",e),null),l=async e=>(console.log("Getting user by ID:",e),null),c=async(e,r)=>(console.log("Updating user:",e,r),{id:e,...r}),u={query:async(e,r=[])=>(console.log(`Pool query: ${e}`,r),{rows:[],rowCount:0}),connect:async()=>(console.log("Pool connection established"),{query:async(e,r=[])=>(console.log(`Connection query: ${e}`,r),{rows:[],rowCount:0}),release:()=>console.log("Connection released")})},d=async e=>(console.log(`Getting category by slug: ${e}`),{id:1,name:"iPhone Parts",slug:e,description:"High-quality iPhone replacement parts"}),m=async()=>(console.log("Getting all categories"),[{id:1,name:"iPhone Parts",slug:"iphone-parts"},{id:2,name:"Samsung Parts",slug:"samsung-parts"},{id:3,name:"iPad Parts",slug:"ipad-parts"},{id:4,name:"Tools",slug:"tools"}]),g=async(e={})=>(console.log("Getting products with filters:",e),[{id:1,name:"iPhone 15 Pro Screen",slug:"iphone-15-pro-screen",price:299.99,category:"iPhone Parts"},{id:2,name:"Samsung S24 Battery",slug:"samsung-s24-battery",price:89.99,category:"Samsung Parts"}]),y=async e=>(console.log(`Getting product by slug: ${e}`),{id:1,name:"iPhone 15 Pro Screen",slug:e,price:299.99,description:"High-quality OLED screen replacement for iPhone 15 Pro",category:"iPhone Parts"}),p={query:t,getConnection:a,transaction:n,createUser:o,getUserByEmail:i,getUserById:l,updateUser:c,pool:u,getCategoryBySlug:d,getCategories:m,getProducts:g,getProductBySlug:y}},45884:(e,r,s)=>{let t,a;s.r(r),s.d(r,{authOptions:()=>p,default:()=>_});var n=s(73227),o=s.n(n),i=s(47449),l=s.n(i),c=s(93598),u=s.n(c),d=s(67096),m=s.n(d);try{t=s(51004)}catch(e){t={query:async()=>({rows:[]}),getUser:async()=>null,getUserByEmail:async()=>null,createUser:async()=>({id:1}),updateUser:async()=>({id:1}),getOrder:async()=>null}}try{a=s(33739)}catch(e){a={verify2FA:async()=>!0,generate2FASecret:async()=>({secret:"placeholder-secret",qrCode:"placeholder-qrcode"}),enable2FA:async()=>!0,disable2FA:async()=>!0,getUserTwoFactorSettings:async()=>({enabled:!1,email_enabled:!1,sms_enabled:!1,duo_enabled:!1,preferred_method:"email"})}}let{query:g}=t,{getUserTwoFactorSettings:y}=a,p={providers:[l()({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){try{let r=(await g("SELECT * FROM users WHERE email = $1",[e.email])).rows[0];if(!r||!await m().compare(e.password,r.password_hash))return null;let s=await y(r.id);if(s?.enabled)return{id:r.id,name:`${r.first_name||""} ${r.last_name||""}`.trim()||r.email.split("@")[0],email:r.email,image:r.image,requiresTwoFactor:!0,twoFactorMethods:{email_enabled:s.email_enabled,sms_enabled:s.sms_enabled,duo_enabled:s.duo_enabled,preferred_method:s.preferred_method}};return{id:r.id,name:`${r.first_name||""} ${r.last_name||""}`.trim()||r.email.split("@")[0],email:r.email,image:r.image}}catch(e){return console.error("Authentication error:",e),null}}}),l()({id:"2fa-completion",name:"2FA Completion",credentials:{userId:{label:"User ID",type:"text"},twoFactorVerified:{label:"2FA Verified",type:"text"}},async authorize(e){try{if(!e.userId||"true"!==e.twoFactorVerified)return null;let r=(await g("SELECT * FROM users WHERE id = $1",[e.userId])).rows[0];if(!r)return null;return{id:r.id,name:`${r.first_name||""} ${r.last_name||""}`.trim()||r.email.split("@")[0],email:r.email,image:r.image}}catch(e){return console.error("2FA completion error:",e),null}}}),u()({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})],pages:{signIn:"/auth/signin",signOut:"/auth/signout",error:"/auth/error",verifyRequest:"/auth/verify-request",newUser:"/auth/new-user"},callbacks:{jwt:async({token:e,user:r,account:s})=>(r&&(e.id=r.id,r.requiresTwoFactor&&(e.requiresTwoFactor=!0,e.twoFactorMethods=r.twoFactorMethods),s?.provider==="2fa-completion"&&(e.requiresTwoFactor=!1,e.twoFactorMethods=void 0)),e),session:async({session:e,token:r})=>(e.user.id=r.id,r.requiresTwoFactor&&(e.requiresTwoFactor=!0,e.twoFactorMethods=r.twoFactorMethods),e),redirect:async({url:e,baseUrl:r})=>e.startsWith(`${r}/auth/2fa`)||e.startsWith(r)?e:r},adapter:{async createUser(e){let{name:r,email:s,image:t}=e,a="",n="";if(r){let e=r.trim().split(" ");a=e[0],n=e.length>1?e.slice(1).join(" "):""}try{let e=(await g("INSERT INTO users (first_name, last_name, email, image) VALUES ($1, $2, $3, $4) RETURNING id, first_name, last_name, email, image",[a,n,s,t])).rows[0];return{...e,name:`${e.first_name||""} ${e.last_name||""}`.trim()||s.split("@")[0]}}catch(e){throw console.error("Error creating user:",e),e}},async getUser(e){try{let r=await g("SELECT id, first_name, last_name, email, email_verified, image FROM users WHERE id = $1",[e]);if(!r.rows[0])return null;let s=r.rows[0];return{...s,name:`${s.first_name||""} ${s.last_name||""}`.trim()||s.email.split("@")[0]}}catch(e){return console.error("Error getting user:",e),null}},async getUserByEmail(e){try{let r=await g("SELECT id, first_name, last_name, email, email_verified, image FROM users WHERE email = $1",[e]);if(!r.rows[0])return null;let s=r.rows[0];return{...s,name:`${s.first_name||""} ${s.last_name||""}`.trim()||s.email.split("@")[0]}}catch(e){return console.error("Error getting user by email:",e),null}},async getUserByAccount({provider:e,providerAccountId:r}){try{let s=await g(`SELECT u.id, u.first_name, u.last_name, u.email, u.email_verified, u.image
           FROM users u
           JOIN accounts a ON u.id = a.user_id
           WHERE a.provider_id = $1 AND a.provider_account_id = $2`,[e,r]);if(!s.rows[0])return null;let t=s.rows[0];return{...t,name:`${t.first_name||""} ${t.last_name||""}`.trim()||t.email.split("@")[0]}}catch(e){return console.error("Error getting user by account:",e),null}},async updateUser(e){let{id:r,name:s,email:t,image:a}=e,n="",o="";if(s){let e=s.trim().split(" ");n=e[0],o=e.length>1?e.slice(1).join(" "):""}try{let e=(await g("UPDATE users SET first_name = $1, last_name = $2, email = $3, image = $4, updated_at = CURRENT_TIMESTAMP WHERE id = $5 RETURNING id, first_name, last_name, email, image",[n,o,t,a,r])).rows[0];return{...e,name:`${e.first_name||""} ${e.last_name||""}`.trim()||t.split("@")[0]}}catch(e){throw console.error("Error updating user:",e),e}},async linkAccount(e){try{let{userId:r,provider:s,type:t,providerAccountId:a,access_token:n,refresh_token:o,expires_at:i}=e;return await g(`INSERT INTO accounts (user_id, provider_type, provider_id, provider_account_id, access_token, refresh_token, access_token_expires)
           VALUES ($1, $2, $3, $4, $5, $6, $7)`,[r,t,s,a,n,o,i?new Date(1e3*i):null]),e}catch(e){throw console.error("Error linking account:",e),e}},async createSession(e){try{return await g("INSERT INTO sessions (user_id, expires, session_token, access_token) VALUES ($1, $2, $3, $4)",[e.userId,e.expires,e.sessionToken,e.accessToken]),e}catch(e){throw console.error("Error creating session:",e),e}},async getSessionAndUser(e){try{let r=(await g("SELECT * FROM sessions WHERE session_token = $1",[e])).rows[0];if(!r)return null;let s=(await g("SELECT id, first_name, last_name, email, email_verified, image FROM users WHERE id = $1",[r.user_id])).rows[0];if(!s)return null;let t={...s,name:`${s.first_name||""} ${s.last_name||""}`.trim()||s.email.split("@")[0]};return{session:r,user:t}}catch(e){return console.error("Error getting session and user:",e),null}},async updateSession(e){try{let{sessionToken:r,expires:s,userId:t}=e;return await g("UPDATE sessions SET expires = $1, user_id = $2 WHERE session_token = $3",[s,t,r]),e}catch(e){throw console.error("Error updating session:",e),e}},async deleteSession(e){try{await g("DELETE FROM sessions WHERE session_token = $1",[e])}catch(e){console.error("Error deleting session:",e)}}},session:{strategy:"jwt",maxAge:2592e3},secret:process.env.NEXTAUTH_SECRET,debug:!1},_=o()(p)},47153:(e,r)=>{var s;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},71802:(e,r,s)=>{e.exports=s(20145)}};