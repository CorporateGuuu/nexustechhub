(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6535],{47338:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/subscription",function(){return s(8175)}])},8175:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return T}});var n,r=s(85893),i=s(67294),a=s(33299),l=s(11163),o=s(41863),c="basil",d="https://js.stripe.com",u="".concat(d,"/").concat(c,"/stripe.js"),p=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,h=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,m=function(){for(var e=document.querySelectorAll('script[src^="'.concat(d,'"]')),t=0;t<e.length;t++){var s,n=e[t];if(s=n.src,p.test(s)||h.test(s))return n}return null},x=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",s=document.createElement("script");s.src="".concat(u).concat(t);var n=document.head||document.body;if(!n)throw Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(s),s},f=function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"7.3.0",startTime:t})},g=null,b=null,v=null,y=function(e,t,s){if(null===e)return null;var n,r=t[0].match(/^pk_test/),i=3===(n=e.version)?"v3":n;r&&i!==c&&console.warn("Stripe.js@".concat(i," was loaded on the page, but @stripe/stripe-js@").concat("7.3.0"," expected Stripe.js@").concat(c,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var a=e.apply(void 0,t);return f(a,s),a},j=!1,w=function(){return n||(n=(null!==g?g:(g=new Promise(function(e,t){if("undefined"==typeof window||"undefined"==typeof document){e(null);return}if(window.Stripe,window.Stripe){e(window.Stripe);return}try{var s,n=m();n?n&&null!==v&&null!==b&&(n.removeEventListener("load",v),n.removeEventListener("error",b),null===(s=n.parentNode)||void 0===s||s.removeChild(n),n=x(null)):n=x(null),v=function(){window.Stripe?e(window.Stripe):t(Error("Stripe.js not available"))},b=function(e){t(Error("Failed to load Stripe.js",{cause:e}))},n.addEventListener("load",v),n.addEventListener("error",b)}catch(e){t(e);return}})).catch(function(e){return g=null,Promise.reject(e)})).catch(function(e){return n=null,Promise.reject(e)}))};Promise.resolve().then(function(){return w()}).catch(function(e){j||console.warn(e)});var N=s(48967),S=s(34155);let _=S.env.NEXT_PUBLIC_SUPABASE_URL||"https://your-supabase-url.supabase.co",E=S.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"your-supabase-anon-key",P=(0,N.eI)(_,E),k=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];j=!0;var n=Date.now();return w().then(function(e){return y(e,t,n)})}(S.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY||"pk_test_your_key"),C=[{id:"price_basic",name:"Basic",description:"Perfect for small repair shops",price:29.99,interval:"month",features:["Access to all basic parts","Standard shipping","Email support","10% discount on tools"]},{id:"price_pro",name:"Professional",description:"Ideal for growing businesses",price:79.99,interval:"month",features:["Access to all parts including premium","Priority shipping","Phone and email support","15% discount on tools","Early access to new products"],popular:!0},{id:"price_enterprise",name:"Enterprise",description:"For large repair operations",price:199.99,interval:"month",features:["Access to all parts including premium and exclusive","Free expedited shipping","Dedicated account manager","25% discount on tools","Early access to new products","Custom bulk pricing","API access"]}];var T=function(){var e,t,s,n,c,d,u;let{data:p,status:h}=(0,a.useSession)(),m=(0,l.useRouter)(),[x,f]=(0,i.useState)(!0),[g,b]=(0,i.useState)(null),[v,y]=(0,i.useState)("month"),[j,w]=(0,i.useState)(!1),[N,S]=(0,i.useState)(!1);(0,i.useEffect)(()=>{"unauthenticated"===h&&m.push("/auth/signin?callbackUrl=/subscription")},[h,m]),(0,i.useEffect)(()=>{var e;async function t(){var e;if(null==p?void 0:null===(e=p.user)||void 0===e?void 0:e.id)try{let{data:e,error:t}=await P.from("subscriptions").select("*, prices(*, products(*))").eq("user_id",p.user.id).in("status",["trialing","active"]).single();if(t&&"PGRST116"!==t.code)throw t;b(e)}catch(e){console.error("Error fetching subscription:",e)}finally{f(!1)}}(null==p?void 0:null===(e=p.user)||void 0===e?void 0:e.id)?t():f(!1)},[p]);let _=async e=>{w(e);try{let t=await fetch("/api/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({price:e,quantity:1,metadata:{userId:p.user.id}})}),{sessionId:s}=await t.json(),n=await k,{error:r}=await n.redirectToCheckout({sessionId:s});if(r)throw r}catch(e){console.error("Error during checkout:",e),alert("An error occurred during checkout. Please try again.")}finally{w(!1)}},E=async()=>{S(!0);try{let e=await fetch("/api/create-portal-link",{method:"POST"}),{url:t}=await e.json();window.location.href=t}catch(e){console.error("Error creating portal link:",e),alert("An error occurred. Please try again.")}finally{S(!1)}};return"loading"===h||x?(0,r.jsx)(o.Z,{title:"Subscription Plans | MDTS",children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,r.jsx)("div",{className:"loading-spinner"}),(0,r.jsx)("p",{className:"ml-4",children:"Loading subscription information..."})]})})}):"unauthenticated"===h?(0,r.jsx)(o.Z,{title:"Subscription Plans | MDTS",children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("p",{children:"Please sign in to view subscription plans."})})})}):(0,r.jsx)(o.Z,{title:"Subscription Plans | MDTS",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"MDTS Subscription Plans"}),(0,r.jsx)("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Choose the perfect plan for your repair business. Unlock premium parts, priority shipping, and exclusive discounts."}),(0,r.jsx)("div",{className:"flex justify-center mt-8 mb-12",children:(0,r.jsxs)("div",{className:"bg-gray-100 p-1 rounded-full",children:[(0,r.jsx)("button",{onClick:()=>y("month"),className:"px-6 py-2 rounded-full ".concat("month"===v?"bg-white shadow-md":"text-gray-700"),children:"Monthly"}),(0,r.jsxs)("button",{onClick:()=>y("year"),className:"px-6 py-2 rounded-full ".concat("year"===v?"bg-white shadow-md":"text-gray-700"),children:["Yearly ",(0,r.jsx)("span",{className:"text-green-500 font-semibold",children:"-20%"})]})]})})]}),g?(0,r.jsxs)("div",{className:"max-w-3xl mx-auto bg-white rounded-lg shadow-lg p-8 mb-12",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Your Current Subscription"}),(0,r.jsx)("span",{className:"px-4 py-1 bg-green-100 text-green-800 rounded-full text-sm font-semibold",children:"trialing"===g.status?"Trial":"Active"})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-2",children:(null===(t=g.prices)||void 0===t?void 0:null===(e=t.products)||void 0===e?void 0:e.name)||"Subscription Plan"}),(0,r.jsx)("p",{className:"text-gray-600",children:(null===(n=g.prices)||void 0===n?void 0:null===(s=n.products)||void 0===s?void 0:s.description)||"Your active subscription plan"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-gray-600",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Billing Period:"})," ",(null===(c=g.prices)||void 0===c?void 0:c.interval_count)===1?"Monthly":"Yearly"]}),(0,r.jsxs)("p",{className:"text-gray-600",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Next billing date:"})," ",new Date(1e3*g.current_period_end).toLocaleDateString()]})]}),(0,r.jsx)("div",{className:"text-right",children:(0,r.jsxs)("p",{className:"text-2xl font-bold",children:["$",((null===(d=g.prices)||void 0===d?void 0:d.unit_amount)/100).toFixed(2),(0,r.jsxs)("span",{className:"text-sm text-gray-600 font-normal",children:["/",null===(u=g.prices)||void 0===u?void 0:u.interval]})]})})]}),(0,r.jsx)("button",{onClick:E,disabled:N,className:"w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition",children:N?"Loading...":"Manage Billing"})]}):(0,r.jsx)("div",{className:"grid md:grid-cols-3 gap-8 max-w-6xl mx-auto",children:C.map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden ".concat(e.popular?"ring-2 ring-blue-500 transform scale-105":""),children:[e.popular&&(0,r.jsx)("div",{className:"bg-blue-500 text-white text-center py-2 font-semibold",children:"Most Popular"}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-2xl font-bold mb-1",children:e.name}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:e.description}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("span",{className:"text-4xl font-bold",children:["$","month"===v?e.price:(.8*e.price*12).toFixed(2)]}),(0,r.jsxs)("span",{className:"text-gray-600",children:["/","month"===v?"month":"year"]})]}),(0,r.jsx)("button",{onClick:()=>_("month"===v?e.id:"".concat(e.id,"_yearly")),disabled:j===e.id,className:"w-full py-3 rounded-lg mb-6 ".concat(e.popular?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-100 text-gray-800 hover:bg-gray-200"," focus:outline-none focus:ring-2 focus:ring-blue-500 transition"),children:j===e.id?"Loading...":"Subscribe"}),(0,r.jsx)("ul",{className:"space-y-3",children:e.features.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("svg",{className:"h-5 w-5 text-green-500 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),(0,r.jsx)("span",{children:e})]},t))})]})]},e.id))}),(0,r.jsxs)("div",{className:"max-w-3xl mx-auto mt-16",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Frequently Asked Questions"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"What's included in each plan?"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Each plan offers different levels of access to our parts catalog, shipping benefits, and support options. The higher-tier plans include additional perks like discounts on tools, early access to new products, and dedicated support."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Can I change my plan later?"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Yes, you can upgrade or downgrade your plan at any time. Changes will take effect at the start of your next billing cycle."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Is there a free trial?"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Yes, all plans come with a 14-day free trial. You can cancel anytime during the trial period and won't be charged."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"How do I cancel my subscription?"}),(0,r.jsx)("p",{className:"text-gray-600",children:'You can cancel your subscription at any time through the "Manage Billing" option. Your subscription will remain active until the end of your current billing period.'})]})]})]})]})})}}},function(e){e.O(0,[1664,5675,250,1863,2888,9774,179],function(){return e(e.s=47338)}),_N_E=e.O()}]);