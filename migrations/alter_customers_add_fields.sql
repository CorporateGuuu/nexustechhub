-- Migration to add new fields to customers table for extended customer info

ALTER TABLE customers
ADD COLUMN IF NOT EXISTS first_name VARCHAR(255),
ADD COLUMN IF NOT EXISTS last_name VARCHAR(255),
ADD COLUMN IF NOT EXISTS contact_person VARCHAR(255),
ADD COLUMN IF NOT EXISTS customer_group_id INTEGER,
ADD COLUMN IF NOT EXISTS email_opt_in INTEGER DEFAULT 0,
ADD COLUMN IF NOT EXISTS sms_opt_in INTEGER DEFAULT 0,
ADD COLUMN IF NOT EXISTS network VARCHAR(255),
ADD COLUMN IF NOT EXISTS orgonization VARCHAR(255),
ADD COLUMN IF NOT EXISTS refered_by VARCHAR(255),
ADD COLUMN IF NOT EXISTS customer_custom_fields JSONB,
ADD COLUMN IF NOT EXISTS title VARCHAR(255),
ADD COLUMN IF NOT EXISTS code INTEGER,
ADD COLUMN IF NOT EXISTS sub_id INTEGER,
ADD COLUMN IF NOT EXISTS store VARCHAR(255),
ADD COLUMN IF NOT EXISTS store_type INTEGER,
ADD COLUMN IF NOT EXISTS image VARCHAR(255),
ADD COLUMN IF NOT EXISTS is_delete INTEGER,
ADD COLUMN IF NOT EXISTS referred_loyaltyid VARCHAR(255),
ADD COLUMN IF NOT EXISTS license_image VARCHAR(255),
ADD COLUMN IF NOT EXISTS driving_licence VARCHAR(255),
ADD COLUMN IF NOT EXISTS xero_id VARCHAR(255),
ADD COLUMN IF NOT EXISTS is_xero INTEGER,
ADD COLUMN IF NOT EXISTS qbo_id VARCHAR(255),
ADD COLUMN IF NOT EXISTS is_qbo INTEGER,
ADD COLUMN IF NOT EXISTS tax_number VARCHAR(255),
ADD COLUMN IF NOT EXISTS comments TEXT,
ADD COLUMN IF NOT EXISTS type VARCHAR(255),
ADD COLUMN IF NOT EXISTS cus_group_id INTEGER,
ADD COLUMN IF NOT EXISTS portal_key VARCHAR(255),
ADD COLUMN IF NOT EXISTS SynchwithMailChimp INTEGER,
ADD COLUMN IF NOT EXISTS MailChimpStatus VARCHAR(255),
ADD COLUMN IF NOT EXISTS gdpr_complianced INTEGER,
ADD COLUMN IF NOT EXISTS forgotten_as_gdpr INTEGER,
ADD COLUMN IF NOT EXISTS from_portal INTEGER,
ADD COLUMN IF NOT EXISTS source INTEGER,
ADD COLUMN IF NOT EXISTS opt_out_reason VARCHAR(255),
ADD COLUMN IF NOT EXISTS mc_list_key VARCHAR(255),
ADD COLUMN IF NOT EXISTS offline_id VARCHAR(255),
ADD COLUMN IF NOT EXISTS tax_class VARCHAR(255),
ADD COLUMN IF NOT EXISTS customer_id_type INTEGER,
ADD COLUMN IF NOT EXISTS customer_id_number VARCHAR(255),
ADD COLUMN IF NOT EXISTS contact_person_relation VARCHAR(255),
ADD COLUMN IF NOT EXISTS customer_tags VARCHAR(255),
ADD COLUMN IF NOT EXISTS customer_rsr_id VARCHAR(255),
ADD COLUMN IF NOT EXISTS import_log_id VARCHAR(255),
ADD COLUMN IF NOT EXISTS avalara_entity_use_code VARCHAR(255),
ADD COLUMN IF NOT EXISTS avalara_custom_entity_use_code VARCHAR(255),
ADD COLUMN IF NOT EXISTS phones VARCHAR(255),
ADD COLUMN IF NOT EXISTS mobiles VARCHAR(255),
ADD COLUMN IF NOT EXISTS emails VARCHAR(255);

-- Create index on customer_group_id for performance
CREATE INDEX IF NOT EXISTS idx_customers_customer_group_id ON customers(customer_group_id);
